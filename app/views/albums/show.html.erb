<% content_for :header do %>
<% end %>

<% content_for :footer do %>
    <%= javascript_include_tag "masonry.pkgd.min.js" %>
    <%= javascript_include_tag "imagesloaded.pkgd.min.js" %>

    <script>
        $(function() 
        {
            var $grid = $('.grid').imagesLoaded( function()
            {
                $grid.masonry({
                    percentPosition: true
                });
            });

            $('#previewViewer').on('show.bs.modal', function (event) 
            {
                var button = $(event.relatedTarget),
                    img_url = $('img', button).prop('src'),
                    modal_body = $('.modal-body', this);
                
                modal_body.empty();
                
                $('<img />',
                { 
                    src: img_url,
                }).appendTo(modal_body);
            });
        });
    </script>
<% end %>

<div class="show-album-container">
	<nav class="mt-3" aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><%= link_to "Gallery", albums_path %></li>
    		<li class="breadcrumb-item active" aria-current="page">Album</li>
		</ol>
	</nav>

    <div class="pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">
          <%= link_to icon('fa-solid', 'angle-left'), albums_path %>
          Album
        </h1>
    </div>

    <p style="color: green"><%= notice %></p>

	<div id="<%= dom_id @album %>">
		<p><strong>Name: </strong><%= @album.name %></p>
    	<p><strong>Description: </strong><%= @album.description %></p>

		<div class="row grid">
			<% @album.images.each do |image| %>
				<div class="col col-sm-6 col-md-4 col-lg-3 mb-4">
					<a href="#previewViewer" data-bs-toggle="modal">
						<%= image_tag image, loading: 'lazy', class: 'img-thumbnail' %>
					</a>
				</div>
			<% end %>
		</div>
  	</div>

    <div class="my-3">
		<%= link_to "Edit this album", edit_album_path(@album) %> |
		<%= link_to "Back to albums", albums_path %>
  		<%= button_to icon('fa-solid', 'trash') +" Delete this album", @album, method: :delete, class: 'btn btn-danger mt-3' %>
	</div>

	<section class="modal fade" id="previewViewer" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="modalTitle">Preview</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex justify-content-center align-items-center"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </section>
</div>